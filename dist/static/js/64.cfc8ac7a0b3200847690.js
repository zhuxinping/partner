webpackJsonp([64],{T4vV:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("X2Oc"),n=a("gyMJ"),r=a("TXDt"),s=a("j1Tj"),l=a("JGtj"),i={name:"update-pop",components:{MHeader:r.a,VDictionary:s.a},mixins:[l.a],data:function(){return{remarkLength:0,pickerFlag:!1,dictionaryArray:[],dictionaryIndex:null,submitFlag:!0,infoInform:Object(o.n)("infoInform"),roleInfo:Object(o.m)("roleInfo")}},beforeRouteEnter:function(e,t,a){e.meta.type=e.params.type,e.meta.schoolId=e.params.schoolId,e.meta.schoolTypeId=e.params.schoolTypeId,e.meta.info=e.params.info,a()},mounted:function(){var e=this;Object(o.f)("CONTACTS_ROLE_TYPE",1).then(function(t){e.roleValue=t}),this.remarkLength=this.roleInfo.remark.length},methods:{handleClose:function(){this.$router.push({path:"/selectPop/"+this.$route.meta.type+"/"+this.$route.meta.info})},selectRole:function(){var e=this;this.roleValue.forEach(function(t,a){t.code===e.roleInfo.roleType&&(Object(o.m)("roleDefault",a),Object(o.m)("roleCode",t.code))}),this.dictionaryArray=this.roleValue,this.dictionaryIndex=Object(o.m)("roleDefault")?~~Object(o.m)("roleDefault"):0,this.pickerFlag=!0},changeStatus:function(){this.dictionaryIndex=null,this.pickerFlag=!1},sureRole:function(e,t,a){this.roleInfo.roleTypeName=t[a].description,Object(o.m)("roleDefault",a),Object(o.m)("roleCode",t[a].code),this.pickerFlag=!1},submitFrom:function(){var e=this;if(this.submitFlag&&this.validate()){var t=new FormData;t.append("contactsDTO.id",this.roleInfo.id),t.append("contactsDTO.schoolId",this.$route.meta.schoolId),t.append("contactsDTO.schoolType",this.$route.meta.schoolTypeId),t.append("contactsDTO.roleType",Object(o.m)("roleCode")?Object(o.m)("roleCode"):1),t.append("contactsDTO.userName",this.roleInfo.userName),t.append("contactsDTO.phone",this.roleInfo.phone),t.append("contactsDTO.wechat",this.roleInfo.wechat.trim()),t.append("contactsDTO.remark",this.roleInfo.remark),t.append("contactsDTO.updatePersonId",this.infoInform.id),t.append("userCenterIdDing",this.infoInform.userCenterId),this.submitFlag=!1,n.a.addRole(t,function(a){a.flag?e.$router.push({path:"/selectPop/"+e.$route.meta.type+"/"+e.$route.meta.info}):(e.submitFlag=!0,Object(o.q)(a.msg),Object(o.g)("接口错误",a,t))}).catch(function(t){e.submitFlag=!0,Object(o.q)("提交异常，请检查网络或者联系管理员！"),Object(o.g)("catch错误",t,{})})}},cancelFrom:function(){this.$router.push({path:"/selectPop/"+this.$route.meta.type+"/"+this.$route.meta.info})}},watch:{"roleInfo.remark":function(e,t){this.remarkLength=e.length}}},c={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container"},[o("div",{staticClass:"flex"},[o("m-header",{attrs:{headerTitle:"修改联系人"},on:{backClick:e.handleClose}})],1),e._v(" "),o("div",{staticClass:"main"},[o("form",{ref:"parent",attrs:{action:"",name:"form"}},[o("ul",{staticClass:"from-table"},[o("li",{staticClass:"table-li"},[o("img",{staticClass:"required",attrs:{src:a("2lpC"),alt:""}}),e._v(" "),o("span",{staticClass:"key-content"},[e._v("角色")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.roleInfo.roleTypeName,expression:"roleInfo.roleTypeName"}],staticClass:"value-content",attrs:{name:"role",type:"text",readonly:"",placeholder:"请选择"},domProps:{value:e.roleInfo.roleTypeName},on:{click:e.selectRole,input:function(t){t.target.composing||e.$set(e.roleInfo,"roleTypeName",t.target.value)}}}),e._v(" "),o("img",{staticClass:"back",attrs:{src:a("CiDD"),alt:""}})]),e._v(" "),o("li",{staticClass:"table-li"},[o("img",{staticClass:"required",attrs:{src:a("2lpC"),alt:""}}),e._v(" "),o("span",{staticClass:"key-content"},[e._v("姓名")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.roleInfo.userName,expression:"roleInfo.userName"}],staticClass:"value-content",attrs:{name:"roleName",type:"text",maxlength:"20",placeholder:"请输入"},domProps:{value:e.roleInfo.userName},on:{input:function(t){t.target.composing||e.$set(e.roleInfo,"userName",t.target.value)}}})]),e._v(" "),o("li",{staticClass:"table-li"},[o("span",{staticClass:"key-content no-require"},[e._v("手机号码")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.roleInfo.phone,expression:"roleInfo.phone"}],staticClass:"value-content",attrs:{name:"rolePhone",type:"text",maxlength:"11",placeholder:"请输入"},domProps:{value:e.roleInfo.phone},on:{input:function(t){t.target.composing||e.$set(e.roleInfo,"phone",t.target.value)}}})]),e._v(" "),o("li",{staticClass:"table-li"},[o("span",{staticClass:"key-content no-require"},[e._v("微信")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.roleInfo.wechat,expression:"roleInfo.wechat"}],staticClass:"value-content",attrs:{type:"text",maxlength:"20",placeholder:"请输入"},domProps:{value:e.roleInfo.wechat},on:{input:function(t){t.target.composing||e.$set(e.roleInfo,"wechat",t.target.value)}}})]),e._v(" "),o("li",{staticClass:"table-li table-textarea"},[e._m(0),e._v(" "),o("div",{staticClass:"value-textarea"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.roleInfo.remark,expression:"roleInfo.remark"}],attrs:{maxlength:"50"},domProps:{value:e.roleInfo.remark},on:{input:function(t){t.target.composing||e.$set(e.roleInfo,"remark",t.target.value)}}}),e._v(" "),o("span",{staticClass:"count"},[e._v(e._s(e.remarkLength)+"/50字")])])])])]),e._v(" "),o("footer",[o("ul",{staticClass:"table-button"},[o("li",{on:{click:e.cancelFrom}},[e._v("取消")]),e._v(" "),o("li",{staticClass:"from",on:{click:e.submitFrom}},[e._v("提交")])])])]),e._v(" "),o("v-dictionary",{attrs:{type:"1",pickerFlag:e.pickerFlag,code:"code",keyValue:"description",titleText:"选择角色",keyArray:e.dictionaryArray,defaultIndex:e.dictionaryIndex},on:{sureData:e.sureRole,changeStatus:e.changeStatus}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"key-top"},[t("span",{staticClass:"key-content key-span no-require"},[this._v("备注")])])}]},m=a("VU/8")(i,c,!1,null,null,null);t.default=m.exports}});