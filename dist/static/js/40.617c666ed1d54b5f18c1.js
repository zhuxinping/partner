webpackJsonp([40],{o1Ds:function(t,e){},yzpT:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("mvHQ"),i=s.n(a),o=(s("ehhp"),s("NVmV")),n=s.n(o),c=s("7+uW"),l=s("X2Oc"),r=s("gyMJ"),d=s("TXDt"),h=s("KgXo");c.default.component(n.a.name,n.a);var u={name:"index",components:{MHeader:d.a,VLoading:h.a},data:function(){return{list:[],infoInform:Object(l.n)("infoInform")?Object(l.n)("infoInform"):"",actionCode:Object(l.n)("actionCode")?i()(Object(l.n)("actionCode")):"",searchSchoolName:"",page:1,pageSize:15,delayLoad:!1,switch:!0,status:["班级周日均活跃比","活跃比","家长活跃率"],statusIndex:0,date:""}},beforeRouteEnter:function(t,e,s){"ZtpartnerHome"!==e.name&&"ZtlivelyAnalyzing"!==e.name||(t.meta.type=0),s()},mounted:function(){document.getElementById("searchSchool").addEventListener("input",Object(l.e)(this.searchSchool,300),!1),this.delayLoad=!0,this.statusIndex=this.$route.meta.type,this.selectType(this.statusIndex,0),this.statusIndex?Object(l.r)("06_01_parent_active_rate","0"):Object(l.r)("06_01_active_ratio","0")},methods:{handleClose:function(){~~Object(l.m)("activeAnaly")?this.$router.push("/livelyAnalyzing"):this.$router.push("/home")},loadMore:function(){if(this.delayLoad)return!1;this.delayLoad=!0,this.selectType(this.statusIndex,0),this.$refs.loading.onchange()},searchSchool:function(){document.getElementsByClassName("main")[0].scrollTop=0,this.page=1,this.selectType(this.statusIndex,1),this.$refs.loading.onchange()},selectType:function(t,e){t?this.getData(e):this.getClassList(e)},getClassList:function(t){var e=this,s={};s.agentId=this.infoInform.id,s.pageNo=this.page,s.pageSize=this.pageSize,s.schoolName=this.searchSchoolName,s.areaIds=this.infoInform.agentChildAuthArea,r.a.getClassGetList(s,function(s){1e4===s.code?(e.date=s.body.yesterdayStr,e.list=t?s.body.activeList:e.list.concat(s.body.activeList),e.delayLoad=!1,e.page++,s.body.activeList.length<=e.pageSize-1&&(e.delayLoad=!0,e.$refs.loading.change())):e.$refs.loading.change(),e.switch=!0})},getData:function(t){var e=this,s={};s.agentId=this.infoInform.id,s.pageNo=this.page,s.pageSize=this.pageSize,s.schoolName=this.searchSchoolName,s.type=this.statusIndex,this.infoInform.agentChildAccount&&(s.areaIds=this.infoInform.agentChildAuthArea),s.userCenterIdDing=this.infoInform.userCenterId,r.a.getActiveReportList(s,function(s){if(1e4===s.code){var a=s.body.date.substr(0,10).split("-");e.date=~~a[1]+"月"+~~a[2]+"日",s.body.list.result.forEach(function(t){t.activeRatio=Object(l.o)(t.activeRatio)}),e.list=t?s.body.list.result:e.list.concat(s.body.list.result),e.delayLoad=!1,e.page++,s.body.list.result.length<=e.pageSize-1&&(e.delayLoad=!0,e.$refs.loading.change())}else e.$refs.loading.change();e.switch=!0})},loadTop:function(){this.page=1,this.selectType(this.statusIndex,1),this.$refs.loading.onchange()},handleTopChange:function(){var t=this;this.switch=!1,setTimeout(function(){t.$refs.loadmore&&t.$refs.loadmore.onTopLoaded()},3e3)},selectStatus:function(t){this.statusIndex=t,this.$route.meta.type=t,this.searchSchoolName="",this.searchSchool()},baseInfrom:function(t,e){if(-1!==this.actionCode.indexOf('"buttonCode":"REPORT_MANAGE_DETAIL"')){if(!this.switch)return;Object(l.n)("basePath","2"),Object(l.n)("base",e),Object(l.n)("state","0"),Object(l.r)("06_01_linkto_school_info","1"),this.$router.push({path:"/reportBaseInfrom/3/"+t})}else Object(l.q)("您没有查看列表详情的权限！")},explain:function(){this.$router.push("/classRatioExplain/0")}}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"flex"},[a("m-header",{attrs:{headerTitle:"活跃报表"},on:{backClick:t.handleClose}}),t._v(" "),a("span",{staticClass:"right-text"},[t._v("昨天("+t._s(t.date)+")")]),t._v(" "),a("ul",{staticClass:"nav-status"},t._l(t.status,function(e,s){return a("li",{key:s,staticClass:"status",on:{click:function(e){return t.selectStatus(s)}}},[a("span",{staticClass:"bg-color",class:s==t.statusIndex?"change-color":""},[t._v(t._s(e))])])}),0),t._v(" "),a("div",{staticClass:"search"},[a("div",{staticClass:"search_school "},[a("img",{attrs:{src:s("4Fmw"),alt:""}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchSchoolName,expression:"searchSchoolName"}],attrs:{id:"searchSchool",type:"text",placeholder:"输入学校名称关键字搜索"},domProps:{value:t.searchSchoolName},on:{input:function(e){e.target.composing||(t.searchSchoolName=e.target.value)}}})])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0==t.statusIndex,expression:"statusIndex == 0"}],staticClass:"b-explain"},[t._m(0),t._v(" "),a("i",{staticClass:"icon-wenhao",on:{click:t.explain}})])],1),t._v(" "),a("mt-loadmore",{directives:[{name:"code",rawName:"v-code",value:"ACTIVE_REPORT_LIST",expression:'"ACTIVE_REPORT_LIST"'}],ref:"loadmore",staticClass:"main",attrs:{"top-method":t.loadTop,topLoadingText:"正在刷新..."},on:{"top-status-change":t.handleTopChange}},[a("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-distance":"100","infinite-scroll-immediate-check":!0}},t._l(t.list,function(e,s){return a("ul",{key:e.id,staticClass:"from-table",on:{click:function(s){return s.preventDefault(),t.baseInfrom(e.schoolId,e)}}},[a("li",{staticClass:"table-li from-li active-li"},[a("span",{staticClass:"li-index"},[t._v(t._s(s+1))]),t._v(" "),a("span",{staticClass:"li-serial"},[t._v(t._s(e.schoolNumber))]),t._v(" "),a("div",{staticClass:"li-school"},[a("span",{staticClass:"school-name"},[t._v(t._s(e.schoolName))])]),t._v(" "),a("div",{staticClass:"li-right"},[0==t.statusIndex?a("span",{staticClass:"radio"},[a("span",{staticStyle:{color:"#00AAFF"}},[t._v(t._s(e.bAboveClassCount))]),t._v("/"+t._s(e.totalClassCount))]):1==t.statusIndex?a("span",{staticClass:"radio",class:2==e.isStandard?"school_radio":""},[t._v(t._s(e.activeRatio))]):a("span",{staticClass:"radio",class:2==e.isStandard?"school_radio":""},[t._v(t._s(e.parentActiveRatioStr))]),t._v(" "),a("i",{staticClass:"icon-right"})])])])}),0),t._v(" "),a("v-loading",{ref:"loading",attrs:{loadingFlag:!0}})],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",[this._v("班级周活比 "),e("em"),this._v("B级以上班级/总数")])}]};var p=s("VU/8")(u,f,!1,function(t){s("o1Ds")},"data-v-f29e6396",null);e.default=p.exports}});