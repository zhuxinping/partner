webpackJsonp([28],{"68+O":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),o=a.n(s),r=(a("ehhp"),a("NVmV")),i=a.n(r),n=a("7+uW"),l=a("X2Oc"),d=a("gyMJ"),c=a("KgXo"),u=a("TXDt"),v=a("PPs4");n.default.component(i.a.name,i.a);var h={name:"Index",components:{MHeader:u.a,VLoading:c.a,DialogModal:v.a},data:function(){return{status:["待审批","待支付","已支付","审批未通过"],statusFlag:2,infoInform:Object(l.n)("infoInform"),list:[],noApprovalNum:0,noPayNum:0,noAgreeNum:0,page:1,pageSize:10,delayLoad:!1,switch:!0,sameSchoolFlag:!1,orderNo:""}},beforeRouteEnter:function(t,e,a){"ZtpartnerHome"!==e.name&&""!==e.name||(t.meta.index=2),a()},mounted:function(){1==~~Object(l.m)("orderFlag")?this.statusFlag=0:2==~~Object(l.m)("orderFlag")?this.statusFlag=2:this.statusFlag=this.$route.meta.index,this.getData(),Object(l.r)("11_01_sales_order","0")},methods:{handleClose:function(){this.$router.push("/home")},addOrder:function(){this.$router.push("/addSmartOrder/null")},selectStatus:function(t){Object(l.m)("orderFlag","0"),this.statusFlag=t,this.$route.meta.index=t,document.getElementsByClassName("main")[0].scrollTop=0,this.list=[],this.page=1,this.orderNo="",this.getData(1),this.$refs.loading.onchange()},loadMore:function(){if(this.delayLoad)return!1;this.delayLoad=!0,this.getData(),this.$refs.loading.onchange()},loadTop:function(){this.page=1,this.getData(1),this.$refs.loading.onchange()},handleTopChange:function(t){var e=this;this.switch=!1,setTimeout(function(){e.$refs.loadmore&&e.$refs.loadmore.onTopLoaded()},1e3)},getData:function(t){var e=this,a={};a.agentId=this.infoInform.id,a.payState=this.statusFlag+1,a.pageNo=this.page,a.pageSize=this.pageSize,a.agentChildAccount=this.infoInform.agentChildAccount,a.agentChildAuthArea=this.infoInform.agentChildAuthArea,d.a.getOrdreDetailList(a,function(a){1e4===a.code?(e.noApprovalNum=a.body.noApprovalNum,e.noPayNum=a.body.noPayNum,e.noAgreeNum=a.body.noAgreeNum,e.list=t?a.body.orderList:e.list.concat(a.body.orderList),e.delayLoad=!1,e.page++,a.body.orderList.length<=e.pageSize-1&&(e.delayLoad=!0,e.$refs.loading.change())):e.$refs.loading.change(),e.switch=!0})},updateOrder:function(t,e,a,s,r){var i=this;setTimeout(function(){if(3===i.statusFlag){var n={productId:t,schoolId:e,schoolName:a,purchaseTimeId:r,orderNo:s};i.$router.push({path:"/updateSmartOrder/"+o()(n)})}else Object(l.m)("orderFlag","0"),i.$router.push({path:"/orderDetail/"+s})})},openAlert:function(t){this.sameSchoolFlag=!0,this.orderNo=t},orderCancel:function(t){var e=this;this.sameSchoolFlag=!1;var a={};a.orderNo=t,a.agentChildAccount=this.infoInform.agentChildAccount,a.agentId=this.infoInform.id,d.a.orderCancel(a,function(t){1e4===t.code?(e.page=1,e.getData(1)):Object(l.q)(t.message)})}}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"flex"},[s("m-header",{attrs:{headerTitle:"智慧校园订单"},on:{backClick:t.handleClose}}),t._v(" "),s("img",{directives:[{name:"code",rawName:"v-code",value:"SMART_CAMPUS_ORDER_ADD",expression:"'SMART_CAMPUS_ORDER_ADD'"}],staticClass:"right-img",attrs:{src:a("eIs4")},on:{click:t.addOrder}}),t._v(" "),s("ul",{staticClass:"nav-status"},t._l(t.status,function(e,a){return s("li",{key:a,staticClass:"status",on:{click:function(e){return t.selectStatus(a)}}},[s("span",{staticClass:"bg-color",class:t.statusFlag===a?"change-color":""},[t._v(t._s(e)+t._s(0==a?"("+t.noApprovalNum+")":1==a?"("+t.noPayNum+")":3==a?"("+t.noAgreeNum+")":""))])])}),0)],1),t._v(" "),s("mt-loadmore",{directives:[{name:"code",rawName:"v-code",value:"SMART_CAMPUS_ORDER_LIST",expression:'"SMART_CAMPUS_ORDER_LIST"'}],ref:"loadmore",staticClass:"main",attrs:{"top-method":t.loadTop,topLoadingText:"正在刷新..."},on:{"top-status-change":t.handleTopChange}},[s("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-distance":"100","infinite-scroll-immediate-check":!0}},[s("ul",{staticClass:"order-list"},t._l(t.list,function(e,o){return s("li",{key:o},[s("div",{staticClass:"order-first"},[s("div",{staticClass:"order-left"},[s("p",{class:2==t.statusFlag&&5==e.orderState?"order-uneffect":""},[t._v(t._s(e.schoolNumber))]),t._v(" "),s("p",{staticClass:"school-name",class:2==t.statusFlag&&5==e.orderState?"order-uneffect":""},[t._v(t._s(e.schoolName))])]),t._v(" "),s("span",{staticClass:"order-right"},[t._v(t._s(2==t.statusFlag?e.paymentTime:e.orderTime))])]),t._v(" "),s("div",{staticClass:"order-second"},[s("div",{staticClass:"order-left"},[s("span",{staticClass:"order-info",class:2==t.statusFlag&&5==e.orderState?"order-uneffect":""},[t._v(t._s(e.productName))]),t._v(" "),s("span",{staticClass:"order-info",class:2==t.statusFlag&&5==e.orderState?"order-uneffect":""},[t._v("使用"+t._s(e.purchaseTime)+"个月"),s("span",{directives:[{name:"show",rawName:"v-show",value:2==t.statusFlag&&5!=e.orderState,expression:"statusFlag==2 && item.orderState!=5"}]},[t._v("，"+t._s(e.vaildStartTime)+"~"+t._s(e.vaildEndTime))])]),t._v(" "),s("span",{staticClass:"order-info",class:2==t.statusFlag&&5==e.orderState?"order-uneffect":""},[t._v("订单金额: "),s("span",{staticClass:"school-radio",class:2==t.statusFlag&&5==e.orderState?"order-uneffect":""},[t._v(t._s(t._f("numThousand")(t._f("numFilter")(e.orderAmount)))+"元")])]),t._v(" "),s("span",{staticClass:"order-info",class:2==t.statusFlag&&5==e.orderState?"order-uneffect":""},[t._v("收益池收入: "),s("span",{staticClass:"school-radio",class:2==t.statusFlag&&5==e.orderState?"order-uneffect":""},[t._v(t._s(e.earningsAmountStr)+"元")])]),t._v(" "),3==t.statusFlag?s("span",{staticClass:"order-info"},[t._v("审批意见: "),s("span",{staticClass:"school-radio"},[t._v(t._s(e.approvalOpinion))])]):t._e()]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:2==t.statusFlag&&5==e.orderState,expression:"statusFlag==2&&item.orderState==5"}],staticClass:"order-right"},[s("img",{attrs:{src:a("i+th"),alt:""}})])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:2!=t.statusFlag,expression:"statusFlag!=2"}],staticClass:"order-thrid"},[s("div",{directives:[{name:"code",rawName:"v-code",value:3==t.statusFlag?"SMART_CAMPUS_ORDER_EDIT":"SMART_CAMPUS_ORDER_PAY",expression:"statusFlag==3?'SMART_CAMPUS_ORDER_EDIT':'SMART_CAMPUS_ORDER_PAY'"},{name:"show",rawName:"v-show",value:1==t.statusFlag||3==t.statusFlag,expression:"statusFlag==1||statusFlag==3"}],on:{click:function(a){return t.updateOrder(e.productId,e.schoolId,e.schoolName,e.orderNo,e.purchaseTime)}}},[t._v(t._s(3==t.statusFlag?"修改":"请联系园长登录幼教后台支付"))]),t._v(" "),s("div",{directives:[{name:"code",rawName:"v-code",value:"SMART_CAMPUS_ORDER_CANCEL",expression:"'SMART_CAMPUS_ORDER_CANCEL'"}],on:{click:function(a){return t.openAlert(e.orderNo)}}},[t._v("取消订单")])])])}),0)]),t._v(" "),s("v-loading",{ref:"loading",attrs:{loadingFlag:!0}})],1),t._v(" "),s("dialogModal",{attrs:{isShow:t.sameSchoolFlag,sureShow:!1}},[s("div",{staticClass:"alert_ul",attrs:{slot:"content"},slot:"content"},[s("p",{staticClass:"title"},[t._v("温馨提示")]),t._v(" "),s("div",{staticClass:"message"},[s("p",[t._v("取消之后，订单将被关闭并失效。您确定要取消订单吗？\n\t\t\t\t")]),t._v(" "),s("ul",{staticClass:"foot"},[s("li",{on:{click:function(e){return t.orderCancel(t.orderNo)}}},[t._v("是")]),t._v(" "),s("li",{on:{click:function(e){t.sameSchoolFlag=!1}}},[t._v("否")])])])])])],1)},staticRenderFns:[]};var m=a("VU/8")(h,g,!1,function(t){a("iM5D")},null,null);e.default=m.exports},"i+th":function(t,e){t.exports="data:image/png;base64,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"},iM5D:function(t,e){}});