webpackJsonp([13],{GSMp:function(t,a){},Vc86:function(t,a){},"Y+IA":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("uL0T"),i=e("gyMJ"),n=e("Gu7T"),l=e.n(n),u=e("X2Oc"),c=(e("v2ns"),e("7QTg")),o=e("cEna"),r=e("mtWM"),d=e.n(r),p={name:"upload",components:{swiper:c.swiper,swiperSlide:c.swiperSlide,swiperImage:s.default,axios:d.a},props:{picValueList:Array,imgMaxlength:Number},data:function(){return{isChoose:!1,progress:[],photoLength:0,sheetVisible:!1,infoInform:Object(u.n)("infoInform")?Object(u.n)("infoInform"):"",imgsFlag:!1,showBigImageFlag:!1,swiperOption:{zoom:!0},previewImg:[],imgData:{accept:"image/gif, image/jpeg, image/png, image/jpg"}}},mounted:function(){this.photoLength=Object(u.m)("picValueList")?Object(u.m)("picValueList").length:0},methods:{showBigImage:function(t){var a=this;this.$set(this.swiperOption,"initialSlide",t),setTimeout(function(){a.showBigImageFlag=!0},10)},closeBigImage:function(){this.showBigImageFlag=!1},deleteImg:function(t,a){this.picValueList.splice(a,1),this.progress.splice(a,1),this.photoLength=this.picValueList.length,this.$emit("change",this.picValueList)},loadFile:function(t){var a=this,s=this,i=t.target.files||t.dataTransfer.files,n=e("rKa9");i.length&&(t.target.values="",(i=[].concat(l()(i))).length>this.imgMaxlength-this.photoLength?Object(u.q)("照片最多上传"+this.imgMaxlength+"张！"):i.forEach(function(t,e){if(a.imgData.accept.indexOf(t.type)<=0)Object(u.q)("请选择正确的图片格式！");else{var i=new FormData;i.append("uploadify",t),i.append("userCenterIdDing",a.infoInform.userCenterId);var l={};l.picUrl=n,l.isFlag=0,l.picType=0,l.picUrl1="",s.$set(s.picValueList,s.picValueList.length,l),s.photoLength=s.picValueList.length,d.a.post(o.a.GETIMGURL,i,{onUploadProgress:function(t){var a=(t.loaded/t.total*100|0)+"%";s.$set(s.progress,s.picValueList.length-e-1,a)}}).then(function(t){t.data.flag?(s.picValueList[s.picValueList.length-e-1].picUrl=t.data.data+"?imageView/1/w/160/h/160",s.picValueList[s.picValueList.length-e-1].picUrl1=t.data.data):Object(u.q)(t.data.msg)}).catch(function(t){Object(u.g)("catch错误",t,{})})}}),this.$emit("change",this.picValueList))}}},m={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"uploadImg"},[s("span",{staticClass:"businessspan"},[t._v("(添加照片"+t._s(t.photoLength)+"/"+t._s(t.imgMaxlength)+"张)")]),t._v(" "),t.picValueList.length||t.progress.length?s("div",{staticClass:"photoCamera"},t._l(t.picValueList,function(a,i){return s("div",{key:i,staticClass:"progress"},[s("img",{staticClass:"itemImg",attrs:{src:a.picUrl,alt:""},on:{click:function(a){t.isChoose=!t.isChoose}}}),t._v(" "),a.picUrl?s("div",{staticClass:"uploadImgDelete"},[s("p",{staticClass:"showImage",on:{click:function(a){return t.showBigImage(i)}}}),t._v(" "),s("img",{staticClass:"deleteImg",attrs:{src:e("H1qD"),alt:""},on:{click:function(e){return t.deleteImg(a,i)}}})]):t._e()])}),0):t._e(),t._v(" "),s("div",{staticClass:"progress-outer"},t._l(t.progress,function(t,a){return s("div",{key:a,staticClass:"progress1"},[s("p",{directives:[{name:"show",rawName:"v-show",value:"100%"!=t,expression:"item == '100%'? false:true"}],staticClass:"progress-p",style:"width:"+t})])}),0),t._v(" "),t.picValueList.length!=t.imgMaxlength?s("div",{staticClass:"uploadCamera"},[s("input",{ref:"upload",staticClass:"uploadCameraIpt",attrs:{type:"file",id:"file",accept:"image/*",multiple:"",readonly:""},on:{change:t.loadFile}}),t._v(" "),s("img",{staticClass:"uploadCameraImg",attrs:{src:e("/+d3"),alt:""}})]):t._e(),t._v(" "),t.showBigImageFlag?s("div",{staticClass:"closeBigImage",on:{click:t.closeBigImage}},[s("swiper",{staticStyle:{height:"100%"},attrs:{options:t.swiperOption}},t._l(t.picValueList,function(t,a){return s("swiper-slide",{key:a},[s("div",{staticClass:"swiper-zoom-container"},[s("img",{attrs:{src:t.picUrl1,alt:""}})])])}),1)],1):t._e(),t._v(" "),s("swiperImage",{attrs:{imgFlag:t.isChoose,previewImg:t.picValueList},on:{change:function(a){t.isChoose=!1}}})],1)},staticRenderFns:[]};var h=e("VU/8")(p,m,!1,function(t){e("GSMp"),e("fqvP")},"data-v-46d85490",null).exports,v=e("TXDt"),g=e("j1Tj"),f={data:function(){return{isChoose:!1,infoInform:Object(u.n)("infoInform"),quaContent:"",quaDetailData:{},summaryLength:0,statusQua:{flag:0,value:"",curName:"请选择",option:[{name:"处理中",value:"2"},{name:"延期处理",value:"3"},{name:"已解决",value:"1"}]},dictionaryIndex:"",currentStatus:"",pickerFlag:!1,dictionaryArray:[],statusNdeal:"",statusHd1:0,statusHd2:0,cachData:{},picValueList:[]}},components:{MHeader:v.a,Upload:h,swiperImage:s.default,VDictionary:g.a},created:function(){this.id=this.$route.query.id,Object(u.r)("11_01_quality_alert_info",0),this.quaDetail()},methods:{quaDetail:function(){var t=this,a={id:this.id,userCenterIdDing:this.infoInform.userCenterId,roleId:this.infoInform.roleId,userType:this.infoInform.userType};i.a.quaDetail(a,function(a){if(1e4===a.code){var e=a.body;t.quaDetailData=e;var s=e.replyInfo;if(s.content&&(t.quaContent=s.content,t.summaryLength=s.content.length),s.images&&s.images.length){var i=[];s.images.forEach(function(t){i.push({isFlag:0,picType:0,picUrl:t,picUrl1:t})}),t.picValueList=i}switch(t.statusNdeal="status-ndeal"+e.status,e.status){case"0":t.statusHd1=1;break;case"2":t.statusQua.option.shift(),t.statusHd2=1;break;default:t.statusHd1=0,t.statusHd2=0,t.statusQua.value=e.status,t.statusQua.option.forEach(function(a,s){a.value===e.status&&(t.statusQua.curName=a.name)})}}else Object(u.q)("获取数据失败")})},handleClose:function(){this.$router.push("/faultAlarm")},formSubmit:function(){var t=this,a=this.statusQua.value;if(!a)return Object(u.q)("请选择处理状态"),0;var e=this.quaContent.trim();if(!e)return Object(u.q)("请输入回复内容"),0;if(e.length<10)return Object(u.q)("回复内容长度不能小于10"),0;var s=[];this.picValueList&&this.picValueList.length&&this.picValueList.forEach(function(t){s.push(t.picUrl1)});var n={id:this.id,status:a,feedbackCont:e,replyPicUrl:s.join(","),agentId:this.infoInform.id,agentName:this.infoInform.agentName};i.a.quaSummit(n,function(a){1e4===a.code?(Object(u.r)("11_01_quality_alert_commit",1),Object(u.n)("quaSubmitFlag",1),t.$router.push("/faultAlarm")):Object(u.q)(a.message)})},changeImg:function(t){this.picValueList=t},selectStatus:function(){this.dictionaryArray=this.statusQua.option,this.dictionaryIndex=this.currentStatus||0,this.pickerFlag=!0},sureCommon:function(t,a,e){this.dictionaryIndex=e,this.statusQua.curName=a[e].name,this.pickerFlag=!1,this.currentStatus=e,this.statusQua.value=this.statusQua.option[e].value},changeStatus:function(){this.pickerFlag=!1,this.dictionaryIndex=null}},watch:{quaContent:function(t,a){this.summaryLength=t.length}}},_={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"container qua-det",class:t.statusHd1?"":"hddel"},[s("m-header",{attrs:{headerTitle:"故障预警"},on:{backClick:t.handleClose}}),t._v(" "),s("div",{staticClass:"main"},[s("div",{staticClass:"fault-det-top"},[s("ul",{staticClass:"det-info-list fault-det-list"},[s("li",[s("div",{staticClass:"td-key"},[t._v("幼儿园名称:")]),t._v(" "),s("div",{staticClass:"td-value text-over"},[t._v(t._s(t.quaDetailData.schoolName))])]),t._v(" "),s("li",[s("div",{staticClass:"td-key"},[t._v("幼儿园编号:")]),t._v(" "),s("div",{staticClass:"td-value text-over"},[t._v(t._s(t.quaDetailData.schoolNumber))])]),t._v(" "),s("li",[s("div",{staticClass:"td-key"},[t._v("班级名称:")]),t._v(" "),s("div",{staticClass:"td-value"},[t._v(t._s(t.quaDetailData.className))])]),t._v(" "),s("li",[s("div",{staticClass:"td-key"},[t._v("设备名称:")]),t._v(" "),s("div",{staticClass:"td-value"},[t._v(t._s(t.quaDetailData.cameraName))])]),t._v(" "),s("li",[s("div",{staticClass:"td-key"},[t._v("家长:")]),t._v(" "),s("div",{staticClass:"td-value"},[t._v(t._s(t.quaDetailData.userName)+" "+t._s(t.quaDetailData.mobile))])]),t._v(" "),s("li",[s("div",{staticClass:"td-key"},[t._v("反馈时间:")]),t._v(" "),t.quaDetailData.historyLsit&&t.quaDetailData.historyLsit.length?s("div",{staticClass:"td-value"},[t._v(t._s(t.quaDetailData.historyLsit[0].createTime))]):t._e()]),t._v(" "),s("li",[s("div",{staticClass:"td-key"},[t._v("问题描述:")]),t._v(" "),s("div",{staticClass:"td-value"},[s("div",{staticClass:"det-feedback-content"},[t._v(t._s(t.quaDetailData.content))]),t._v(" "),t.quaDetailData.image?s("img",{staticClass:"det-feedback-img",attrs:{src:t.quaDetailData.image,alt:""},on:{click:function(a){t.isChoose=!t.isChoose}}}):t._e()])])]),t._v(" "),s("span",{staticClass:"status-ndeal",class:t.statusNdeal})]),t._v(" "),s("ul",{staticClass:"detail-status fault-det-list"},[s("li",[t.statusHd1||t.statusHd2?[s("img",{staticClass:"required",attrs:{src:e("2lpC"),alt:""}}),s("span",{staticClass:"td-name"},[t._v("处理状态:")]),t._v(" "),s("span",{staticClass:"detail-status-sel layer-sel",on:{click:t.selectStatus}},[t._v(t._s(t.statusQua.curName)),s("i")])]:[s("span",{staticClass:"td-name"},[t._v("处理状态:")]),t._v(" "),s("span",{staticClass:"detail-status-sel layer-sel npd"},[t._v(t._s(t.statusQua.curName))])]],2),t._v(" "),s("li",[t.statusHd1?s("img",{staticClass:"required",attrs:{src:e("2lpC"),alt:""}}):t._e(),s("span",{staticClass:"td-name"},[t._v("回复内容:")]),t._v(" "),s("div",{staticClass:"qua-content"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.quaContent,expression:"quaContent"}],attrs:{name:"content",placeholder:"请输入回复家长的话",maxlength:"1000",disabled:!t.statusHd1},domProps:{value:t.quaContent},on:{input:function(a){a.target.composing||(t.quaContent=a.target.value)}}}),t._v(" "),s("span",{staticClass:"limit-count"},[t._v(t._s(t.summaryLength)+"/1000字")])])]),t._v(" "),s("li",[s("span",{staticClass:"td-name"},[t._v("图片:")]),t._v(" "),s("upload",{ref:"upload",attrs:{imgMaxlength:4,picValueList:t.picValueList},on:{change:t.changeImg}})],1)]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.statusQua.flag,expression:"statusQua.flag"}]},[s("div",{staticClass:"layer-status"},[s("ul",t._l(t.statusQua.option,function(a,e){return s("li",{key:a.value},[s("div",{staticClass:"form-chk-ct"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.statusQua.value,expression:"statusQua.value"}],attrs:{type:"radio",id:"layer-ipt"+e,name:"layer-ipt"},domProps:{value:a.value,checked:t._q(t.statusQua.value,a.value)},on:{click:function(e){return t.statusChange(a.value,a.name)},change:function(e){return t.$set(t.statusQua,"value",a.value)}}}),s("label",{attrs:{for:"layer-ipt"+e}})]),s("label",{attrs:{for:"layer-ipt"+e}},[t._v(t._s(a.name))])])}),0)]),t._v(" "),s("div",{staticClass:"layer-shade",on:{click:function(a){t.statusQua.flag=0}}})]),t._v(" "),s("swiperImage",{attrs:{chooseFlag:t.isChoose,schoolPicUrl:t.quaDetailData.image},on:{change:function(a){t.isChoose=!1}}})],1),t._v(" "),t.statusHd1||t.statusHd2?s("button",{directives:[{name:"code",rawName:"v-code",value:"VEDIO_ALARM_SUBMIT",expression:'"VEDIO_ALARM_SUBMIT"'}],staticClass:"btn submit-btn",on:{click:t.formSubmit}},[t._v("提交")]):t._e(),t._v(" "),s("v-dictionary",{ref:"dictionary",attrs:{type:"1",pickerFlag:t.pickerFlag,code:"value",keyValue:"name",titleText:"故障预警",keyArray:t.dictionaryArray,defaultIndex:t.dictionaryIndex},on:{sureData:t.sureCommon,changeStatus:t.changeStatus}})],1)},staticRenderFns:[]};var C=e("VU/8")(f,_,!1,function(t){e("o4yE"),e("Vc86")},"data-v-2716a80f",null);a.default=C.exports},fqvP:function(t,a){},o4yE:function(t,a){}});