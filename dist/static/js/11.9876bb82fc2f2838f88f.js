webpackJsonp([11],{"0vLy":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("mvHQ"),s=n.n(i),o=(n("HdXH"),n("S9KX")),r=n.n(o),a=(n("ehhp"),n("NVmV")),l=n.n(a),c=n("7+uW"),u=n("X2Oc"),d=n("gyMJ"),f=n("TXDt"),h=n("KgXo");c.default.component(l.a.name,l.a),c.default.component(r.a.name,r.a);var p={name:"pop-list",components:{MHeader:f.a,Loadmore:l.a,CellSwipe:r.a,VLoading:h.a},data:function(){return{actionCode:s()(Object(u.n)("actionCode")),list:[],infoInform:Object(u.n)("infoInform"),page:1,pageSize:10,loadingFlag:!0,delayLoad:!1,switch:!0,addPersonNull:!1,updatePersonNull:!1,deletePersonNull:!1,info:JSON.parse(this.$route.meta.info),schoolTypeId:""}},beforeRouteEnter:function(t,e,n){t.meta.type=t.params.type,t.meta.info=t.params.info,n()},mounted:function(){var t=this.info.schoolType;this.schoolTypeId="报备园"===t?1:"正式园"===t?2:"演示园"===t?3:"演示园报备"===t?4:"无效园"===t?5:"异常园"===t?6:"自主注册园"===t?7:"潜在园"===t?8:"报备申请"===t?9:0,this.keepAction(),this.getData()},methods:{touchend:function(t){t.stopPropagation(),t.cancelBubble=!0},setSwitch:function(){this.switch=!1},handleClose:function(){Object(u.q)("请选择联系人！")},keepAction:function(){~~this.$route.meta.type?(-1!==this.actionCode.indexOf("CALL_ON_CONTACT_ADD")&&(this.addPersonNull=!0),-1!==this.actionCode.indexOf("CALL_ON_CONTACT_EDIT")&&(this.updatePersonNull=!0),-1!==this.actionCode.indexOf("CALL_ON_CONTACT_DELETE")&&(this.deletePersonNull=!0)):(-1!==this.actionCode.indexOf("RETURN_VISIT_CONTACT_ADD")&&(this.addPersonNull=!0),-1!==this.actionCode.indexOf("RETURN_VISIT_CONTACT_EDIT")&&(this.updatePersonNull=!0),-1!==this.actionCode.indexOf("RETURN_VISIT_CONTACT_DELETE")&&(this.deletePersonNull=!0))},addPerson:function(){this.$router.push({path:"/addPop/"+this.$route.meta.type+"/"+this.info.schoolId+"/"+this.schoolTypeId+"/"+s()(this.info)})},updatePerson:function(t){var e=this,n={};n.id=t.id,n.userCenterIdDing=this.infoInform.userCenterId,d.a.getPersonBase(n,function(t){t.flag?(Object(u.m)("roleInfo",t.data),e.$router.push({path:"/updatePop/"+e.$route.meta.type+"/"+e.info.schoolId+"/"+e.schoolTypeId+"/"+s()(e.info)})):(Object(u.q)(t.msg),Object(u.g)("接口错误",t,n))}).catch(function(t){Object(u.g)("catch错误",t,{})})},deletePerson:function(t){var e=this;dd.device.notification.confirm({title:"温馨提示",message:"确定要删除联系人吗？",buttonLabels:["取消","确定"],onSuccess:function(n){if(n.buttonIndex){var i=new FormData;i.append("id",t.id),i.append("userCenterIdDing",e.infoInform.userCenterId),d.a.deleteRole(i,function(t){t.flag?(e.page=1,e.getData(1)):(Object(u.q)(t.msg),Object(u.g)("接口错误",t,i))})}},onFail:function(t){Object(u.g)("钉钉删除联系人回调",t,{})}})},loadMore:function(){if(this.delayLoad)return!1;this.delayLoad=!0,this.getData(),this.$refs.loading.onchange()},loadTop:function(){this.page=1,this.getData(1),this.$refs.loading.onchange()},handleTopChange:function(t){var e=this;this.switch=!1,setTimeout(function(){e.$refs.loadmore&&e.$refs.loadmore.onTopLoaded()},3e3)},selectRole:function(t,e,n){this.switch&&(this.info.userName=t,this.info.id=e,this.info.userNameBack=n,Object(u.m)("schoolContactsId",e),~~this.$route.meta.type?this.$router.push({path:"/visitedAdd/"+s()(this.info)}):this.$router.push({path:"/backvisitedAdd/"+s()(this.info)}))},getData:function(t){var e=this,n={"contactsDTO.schoolId":this.info.schoolId,"contactsDTO.schoolType":this.schoolTypeId,"page.pageNo":this.page,"page.pageSize":this.pageSize};n.userCenterIdDing=this.infoInform.userCenterId,d.a.getRoleList(n,function(n){n.flag&&n.data?(e.list=t?n.data.list:e.list.concat(n.data.list),e.delayLoad=!1,e.page++,n.data.list.length<=e.pageSize-1&&(e.delayLoad=!0,e.$refs.loading.change())):e.$refs.loading.change(),e.switch=!0})}}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("div",{staticClass:"flex"},[i("m-header",{attrs:{headerTitle:"选择联系人"},on:{backClick:t.handleClose}}),t._v(" "),t.addPersonNull?i("span",{staticClass:"right-text",on:{click:t.addPerson}},[t._v("添加联系人")]):t._e()],1),t._v(" "),i("mt-loadmore",{ref:"loadmore",staticClass:"main",attrs:{"top-method":t.loadTop,topLoadingText:"正在刷新..."},on:{"top-status-change":t.handleTopChange}},[i("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{"infinite-scroll-distance":"100","infinite-scroll-immediate-check":!0}},t._l(t.list,function(e,s){return i("mt-cell-swipe",{key:s,attrs:{right:0==e.fixedFlag?[{content:"修改",style:{background:"#74A9FF",color:"#fff",width:"60px",height:"100%",display:!1===t.updatePersonNull?"none !important":"show"},handler:function(){return t.updatePerson(e)}},{content:"删除",style:{background:"#ef7980",color:"#fff",width:"60px",height:"100%",display:!1===t.deletePersonNull?"none !important":"show"},handler:function(){return t.deletePerson(e)}}]:[]}},[i("ul",{staticClass:"main-list",staticStyle:{border:"0"},on:{click:function(n){return n.preventDefault(),t.selectRole(e.userName,e.id,e.userNameBack)},touchend:function(e){return t.touchend(e)}}},[i("li",{staticClass:"first"},[i("img",{staticClass:"logo",attrs:{src:n("m3Z4"),alt:""}}),t._v(" "),i("div",{staticClass:"right-content"},[i("div",{staticClass:"person-content"},[i("span",[t._v(t._s(e.userName))])]),t._v(" "),i("div",{staticClass:"person-content person-content-bottom"},[i("span",[t._v(t._s(e.roleTypeName))]),t._v(" "),i("span",[t._v(t._s(e.phone))]),t._v(" "),i("span",[t._v(t._s(e.wechat))])])])]),t._v(" "),i("li",{staticClass:"person-remark"},[t._v(t._s(1==e.fixedFlag?"客户填写的信息":e.remark))])])])}),1),t._v(" "),i("v-loading",{ref:"loading",attrs:{loadingFlag:t.loadingFlag}})],1)],1)},staticRenderFns:[]},g=n("VU/8")(p,m,!1,null,null,null);e.default=g.exports},"7YS2":function(t,e,n){t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=212)}({0:function(t,e){t.exports=function(t,e,n,i,s){var o,r=t=t||{},a=typeof t.default;"object"!==a&&"function"!==a||(o=t,r=t.default);var l,c="function"==typeof r?r.options:r;if(e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns),i&&(c._scopeId=i),s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},c._ssrRegister=l):n&&(l=n),l){var u=c.functional,d=u?c.render:c.beforeCreate;u?c.render=function(t,e){return l.call(e),d(t,e)}:c.beforeCreate=d?[].concat(d,l):[l]}return{esModule:o,exports:r,options:c}}},116:function(t,e){},134:function(t,e,n){var i=n(0)(n(56),n(186),function(t){n(116)},null,null);t.exports=i.exports},17:function(t,e){t.exports=n("joTY")},186:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a",{staticClass:"mint-cell",attrs:{href:t.href}},[t.isLink?n("span",{staticClass:"mint-cell-mask"}):t._e(),t._v(" "),n("div",{staticClass:"mint-cell-left"},[t._t("left")],2),t._v(" "),n("div",{staticClass:"mint-cell-wrapper"},[n("div",{staticClass:"mint-cell-title"},[t._t("icon",[t.icon?n("i",{staticClass:"mintui",class:"mintui-"+t.icon}):t._e()]),t._v(" "),t._t("title",[n("span",{staticClass:"mint-cell-text",domProps:{textContent:t._s(t.title)}}),t._v(" "),t.label?n("span",{staticClass:"mint-cell-label",domProps:{textContent:t._s(t.label)}}):t._e()])],2),t._v(" "),n("div",{staticClass:"mint-cell-value",class:{"is-link":t.isLink}},[t._t("default",[n("span",{domProps:{textContent:t._s(t.value)}})])],2),t._v(" "),t.isLink?n("i",{staticClass:"mint-cell-allow-right"}):t._e()]),t._v(" "),n("div",{staticClass:"mint-cell-right"},[t._t("right")],2)])},staticRenderFns:[]}},212:function(t,e,n){t.exports=n(22)},22:function(t,e,n){"use strict";var i=n(134),s=n.n(i);Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"default",function(){return s.a})},56:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n(17),e.default={name:"mt-cell",props:{to:[String,Object],icon:String,title:String,label:String,isLink:Boolean,value:{}},computed:{href:function(){var t=this;if(this.to&&!this.added&&this.$router){var e=this.$router.match(this.to);return e.matched.length?(this.$nextTick(function(){t.added=!0,t.$el.addEventListener("click",t.handleClick)}),e.fullPath||e.path):this.to}return this.to}},methods:{handleClick:function(t){t.preventDefault(),this.$router.push(this.href)}}}}})},HdXH:function(t,e){},S9KX:function(t,e,n){t.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=213)}({0:function(t,e){t.exports=function(t,e,n,i,s){var o,r=t=t||{},a=typeof t.default;"object"!==a&&"function"!==a||(o=t,r=t.default);var l,c="function"==typeof r?r.options:r;if(e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns),i&&(c._scopeId=i),s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},c._ssrRegister=l):n&&(l=n),l){var u=c.functional,d=u?c.render:c.beforeCreate;u?c.render=function(t,e){return l.call(e),d(t,e)}:c.beforeCreate=d?[].concat(d,l):[l]}return{esModule:o,exports:r,options:c}}},1:function(t,e){t.exports=n("7+uW")},102:function(t,e){},12:function(t,e,n){"use strict";e.a={bind:function(t,e,n){var i=function(e){n.context&&!t.contains(e.target)&&n.context[t["@@clickoutsideContext"].methodName]()};t["@@clickoutsideContext"]={documentHandler:i,methodName:e.expression,arg:e.arg||"click"},document.addEventListener(t["@@clickoutsideContext"].arg,i)},update:function(t,e){t["@@clickoutsideContext"].methodName=e.expression},unbind:function(t){document.removeEventListener(t["@@clickoutsideContext"].arg,t["@@clickoutsideContext"].documentHandler)},install:function(t){t.directive("clickoutside",{bind:this.bind,unbind:this.unbind})}}},133:function(t,e,n){var i=n(0)(n(55),n(171),function(t){n(102)},null,null);t.exports=i.exports},171:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("x-cell",{directives:[{name:"clickoutside",rawName:"v-clickoutside:touchstart",value:t.swipeMove,expression:"swipeMove",arg:"touchstart"}],ref:"cell",staticClass:"mint-cell-swipe",attrs:{title:t.title,icon:t.icon,label:t.label,to:t.to,"is-link":t.isLink,value:t.value},nativeOn:{click:function(e){t.swipeMove()},touchstart:function(e){t.startDrag(e)},touchmove:function(e){t.onDrag(e)},touchend:function(e){t.endDrag(e)}}},[n("div",{ref:"right",staticClass:"mint-cell-swipe-buttongroup",slot:"right"},t._l(t.right,function(e){return n("a",{staticClass:"mint-cell-swipe-button",style:e.style,domProps:{innerHTML:t._s(e.content)},on:{click:function(n){n.preventDefault(),n.stopPropagation(),e.handler&&e.handler(),t.swipeMove()}}})})),t._v(" "),n("div",{ref:"left",staticClass:"mint-cell-swipe-buttongroup",slot:"left"},t._l(t.left,function(e){return n("a",{staticClass:"mint-cell-swipe-button",style:e.style,domProps:{innerHTML:t._s(e.content)},on:{click:function(n){n.preventDefault(),n.stopPropagation(),e.handler&&e.handler(),t.swipeMove()}}})})),t._v(" "),t._t("default"),t._v(" "),t.$slots.title?n("span",{slot:"title"},[t._t("title")],2):t._e(),t._v(" "),t.$slots.icon?n("span",{slot:"icon"},[t._t("icon")],2):t._e()],2)},staticRenderFns:[]}},2:function(t,e,n){"use strict";var i=n(1),s=n.n(i);n.d(e,"c",function(){return c}),e.a=function(t,e){if(!t)return;for(var n=t.className,i=(e||"").split(" "),s=0,o=i.length;s<o;s++){var r=i[s];r&&(t.classList?t.classList.add(r):u(t,r)||(n+=" "+r))}t.classList||(t.className=n)},e.b=function(t,e){if(!t||!e)return;for(var n=e.split(" "),i=" "+t.className+" ",s=0,o=n.length;s<o;s++){var a=n[s];a&&(t.classList?t.classList.remove(a):u(t,a)&&(i=i.replace(" "+a+" "," ")))}t.classList||(t.className=r(i))};var o=s.a.prototype.$isServer,r=(o||Number(document.documentMode),function(t){return(t||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")}),a=!o&&document.addEventListener?function(t,e,n){t&&e&&n&&t.addEventListener(e,n,!1)}:function(t,e,n){t&&e&&n&&t.attachEvent("on"+e,n)},l=!o&&document.removeEventListener?function(t,e,n){t&&e&&t.removeEventListener(e,n,!1)}:function(t,e,n){t&&e&&t.detachEvent("on"+e,n)},c=function(t,e,n){var i=function(){n&&n.apply(this,arguments),l(t,e,i)};a(t,e,i)};function u(t,e){if(!t||!e)return!1;if(-1!==e.indexOf(" "))throw new Error("className should not contain space.");return t.classList?t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}},21:function(t,e,n){"use strict";var i=n(133),s=n.n(i);Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"default",function(){return s.a})},213:function(t,e,n){t.exports=n(21)},3:function(t,e){t.exports=n("7YS2")},4:function(t,e){t.exports=n("lrMw")},55:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),s=n(3),o=n.n(s),r=n(12);n(4),e.default={name:"mt-cell-swipe",components:{XCell:o.a},directives:{Clickoutside:r.a},props:{to:String,left:Array,right:Array,icon:String,title:String,label:String,isLink:Boolean,value:{}},data:function(){return{start:{x:0,y:0}}},mounted:function(){this.wrap=this.$refs.cell.$el.querySelector(".mint-cell-wrapper"),this.leftElm=this.$refs.left,this.rightElm=this.$refs.right,this.leftWrapElm=this.leftElm.parentNode,this.rightWrapElm=this.rightElm.parentNode,this.leftWidth=this.leftElm.getBoundingClientRect().width,this.rightWidth=this.rightElm.getBoundingClientRect().width,this.leftDefaultTransform=this.translate3d(-this.leftWidth-1),this.rightDefaultTransform=this.translate3d(this.rightWidth),this.rightWrapElm.style.webkitTransform=this.rightDefaultTransform,this.leftWrapElm.style.webkitTransform=this.leftDefaultTransform},methods:{resetSwipeStatus:function(){this.swiping=!1,this.opened=!0,this.offsetLeft=0},translate3d:function(t){return"translate3d("+t+"px, 0, 0)"},setAnimations:function(t){this.wrap.style.transitionDuration=t,this.rightWrapElm.style.transitionDuration=t,this.leftWrapElm.style.transitionDuration=t},swipeMove:function(t){void 0===t&&(t=0),this.wrap.style.webkitTransform=this.translate3d(t),this.rightWrapElm.style.webkitTransform=this.translate3d(this.rightWidth+t),this.leftWrapElm.style.webkitTransform=this.translate3d(-this.leftWidth+t),t&&(this.swiping=!0)},swipeLeaveTransition:function(t){var e=this;setTimeout(function(){return e.swipeLeave=!0,t>0&&-e.offsetLeft>.4*e.rightWidth?(e.swipeMove(-e.rightWidth),void e.resetSwipeStatus()):t<0&&e.offsetLeft>.4*e.leftWidth?(e.swipeMove(e.leftWidth),void e.resetSwipeStatus()):(e.swipeMove(0),void n.i(i.c)(e.wrap,"webkitTransitionEnd",function(t){e.wrap.style.webkitTransform="",e.rightWrapElm.style.webkitTransform=e.rightDefaultTransform,e.leftWrapElm.style.webkitTransform=e.leftDefaultTransform,e.swipeLeave=!1,e.swiping=!1}))},0)},startDrag:function(t){t=t.changedTouches?t.changedTouches[0]:t,this.dragging=!0,this.start.x=t.pageX,this.start.y=t.pageY,this.direction=""},onDrag:function(t){if(this.opened)return this.swiping||(this.swipeMove(0),this.setAnimations("")),void(this.opened=!1);if(this.dragging){var e=t.changedTouches?t.changedTouches[0]:t,n=e.pageY-this.start.y,i=this.offsetLeft=e.pageX-this.start.x,s=Math.abs(n),o=Math.abs(i);if(this.setAnimations("0ms"),""===this.direction&&(this.direction=o>s?"horizonal":"vertical"),"horizonal"===this.direction){if(t.preventDefault(),t.stopPropagation(),!!(o<5||o>=5&&s>=1.73*o))return;i<0&&-i>this.rightWidth||i>0&&i>this.leftWidth||i>0&&!this.leftWidth||i<0&&!this.rightWidth||this.swipeMove(i)}}},endDrag:function(){this.direction="",this.setAnimations(""),this.swiping&&this.swipeLeaveTransition(this.offsetLeft>0?-1:1)}}}}})},joTY:function(t,e){},lrMw:function(t,e){}});